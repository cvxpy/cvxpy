# Worker images
#  VS 2015 runs on Windows Server 2012 R2
#  VS 2017 runs on Windows Server 2016
#  see: https://www.appveyor.com/docs/build-environment/#build-vm-configurations
#  for details on these environments.
image:
  - Visual Studio 2015
  - Visual Studio 2017

environment:
    global:
          PYTHON: "C:\\conda"
          ENV_NAME: "testenv"
    matrix:
          fast_finish: true
          - PYTHON_VERSION: "2.7"
          - PYTHON_VERSION: "3.5"
          - MINICONDA_FILENAME: "Miniconda2-latest-Windows-x86_64.exe"
          - MINICONDA_FILENAME: "Miniconda3-latest-Windows-x86_64.exe"

# SCS is a required solver, and it has no 32 bit distribution
# on conda; cvxpy's AppVeyor tests will only use 64 bit Windows.
platform:
    - x64

# The install phase is contained in a PowerShell script.
install:
    - "powershell continuous_integration\\appveyor_install.ps1"

# Not a .NET project, we build CVXPY in the install step instead.
build: false

# The test phase uses Windows CMD commands (not PowerShell).
test_script:
    - "PATH %PYTHON%;%PYTHON%\\Scripts;%PATH%"
    - "echo %PATH%"
    - "activate %ENV_NAME%"
    - "conda env list"
    - "nosetests cvxpy"
