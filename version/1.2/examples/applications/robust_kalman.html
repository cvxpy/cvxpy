
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Robust Kalman filtering for vehicle tracking &#8212; CVXPY 1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/cvxpy_alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="robust-kalman-filtering-for-vehicle-tracking">
<h1>Robust Kalman filtering for vehicle tracking<a class="headerlink" href="#robust-kalman-filtering-for-vehicle-tracking" title="Permalink to this heading">¶</a></h1>
<p>We will try to pinpoint the location of a moving vehicle with high
accuracy from noisy sensor data. We’ll do this by modeling the vehicle
state as a discrete-time linear dynamical system. Standard <strong>Kalman
filtering</strong> can be used to approach this problem when the sensor noise
is assumed to be Gaussian. We’ll use <strong>robust Kalman filtering</strong> to get
a more accurate estimate of the vehicle state for a non-Gaussian case
with outliers.</p>
</section>
<section id="problem-statement">
<h1>Problem statement<a class="headerlink" href="#problem-statement" title="Permalink to this heading">¶</a></h1>
<p>A discrete-time linear dynamical system consists of a sequence of state
vectors <span class="math notranslate nohighlight">\(x_t \in \mathbf{R}^n\)</span>, indexed by time
<span class="math notranslate nohighlight">\(t \in \lbrace 0, \ldots, N-1 \rbrace\)</span> and dynamics equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
x_{t+1} &amp;= Ax_t + Bw_t\\
y_t &amp;=Cx_t + v_t,
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_t \in \mathbf{R}^m\)</span> is an input to the dynamical system
(say, a drive force on the vehicle), <span class="math notranslate nohighlight">\(y_t \in \mathbf{R}^r\)</span> is a
state measurement, <span class="math notranslate nohighlight">\(v_t \in \mathbf{R}^r\)</span> is noise, <span class="math notranslate nohighlight">\(A\)</span> is
the drift matrix, <span class="math notranslate nohighlight">\(B\)</span> is the input matrix, and <span class="math notranslate nohighlight">\(C\)</span> is the
observation matrix.</p>
<p>Given <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(C\)</span>, and <span class="math notranslate nohighlight">\(y_t\)</span> for
<span class="math notranslate nohighlight">\(t = 0, \ldots, N-1\)</span>, the goal is to estimate <span class="math notranslate nohighlight">\(x_t\)</span> for
<span class="math notranslate nohighlight">\(t = 0, \ldots, N-1\)</span>.</p>
</section>
<section id="kalman-filtering">
<h1>Kalman filtering<a class="headerlink" href="#kalman-filtering" title="Permalink to this heading">¶</a></h1>
<p>A Kalman filter estimates <span class="math notranslate nohighlight">\(x_t\)</span> by solving the optimization
problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ll}
\mbox{minimize} &amp; \sum_{t=0}^{N-1} \left(
\|w_t\|_2^2 + \tau \|v_t\|_2^2\right)\\
\mbox{subject to} &amp; x_{t+1} = Ax_t + Bw_t,\quad t=0,\ldots, N-1\\
&amp; y_t = Cx_t+v_t,\quad t = 0, \ldots, N-1,
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is a tuning parameter. This problem is actually a
least squares problem, and can be solved via linear algebra, without the
need for more general convex optimization. Note that since we have no
observation <span class="math notranslate nohighlight">\(y_{N}\)</span>, <span class="math notranslate nohighlight">\(x_N\)</span> is only constrained via
<span class="math notranslate nohighlight">\(x_{N} = Ax_{N-1} + Bw_{N-1}\)</span>, which is trivially resolved when
<span class="math notranslate nohighlight">\(w_{N-1} = 0\)</span> and <span class="math notranslate nohighlight">\(x_{N} = Ax_{N-1}\)</span>. We maintain this
vestigial constraint only because it offers a concise problem statement.</p>
<p>This model performs well when <span class="math notranslate nohighlight">\(w_t\)</span> and <span class="math notranslate nohighlight">\(v_t\)</span> are Gaussian.
However, the quadratic objective can be influenced by large outliers,
which degrades the accuracy of the recovery. To improve estimation in
the presence of outliers, we can use <strong>robust Kalman filtering</strong>.</p>
</section>
<section id="robust-kalman-filtering">
<h1>Robust Kalman filtering<a class="headerlink" href="#robust-kalman-filtering" title="Permalink to this heading">¶</a></h1>
<p>To handle outliers in <span class="math notranslate nohighlight">\(v_t\)</span>, robust Kalman filtering replaces the
quadratic cost with a Huber cost, which results in the convex
optimization problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ll}
\mbox{minimize} &amp; \sum_{t=0}^{N-1} \left( \|w_t\|^2_2 + \tau \phi_\rho(v_t) \right)\\
\mbox{subject to} &amp; x_{t+1} = Ax_t + Bw_t,\quad t=0,\ldots, N-1\\
&amp; y_t = Cx_t+v_t,\quad t=0,\ldots, N-1,
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_\rho\)</span> is the Huber function</p>
<div class="math notranslate nohighlight">
\[\begin{split}\phi_\rho(a)= \left\{ \begin{array}{ll} \|a\|_2^2 &amp; \|a\|_2\leq \rho\\
2\rho \|a\|_2-\rho^2 &amp; \|a\|_2&gt;\rho.
\end{array}\right.\end{split}\]</div>
<p>The Huber penalty function penalizes estimation error linearly outside
of a ball of radius <span class="math notranslate nohighlight">\(\rho\)</span>, whereas in standard Kalman filtering,
all errors are penalized quadratically. Thus, large errors are penalized
less harshly, making this model more robust to outliers.</p>
</section>
<section id="vehicle-tracking-example">
<h1>Vehicle tracking example<a class="headerlink" href="#vehicle-tracking-example" title="Permalink to this heading">¶</a></h1>
<p>We’ll apply standard and robust Kalman filtering to a vehicle tracking
problem with state <span class="math notranslate nohighlight">\(x_t \in \mathbf{R}^4\)</span>, where
<span class="math notranslate nohighlight">\((x_{t,0}, x_{t,1})\)</span> is the position of the vehicle in two
dimensions, and <span class="math notranslate nohighlight">\((x_{t,2}, x_{t,3})\)</span> is the vehicle velocity. The
vehicle has unknown drive force <span class="math notranslate nohighlight">\(w_t\)</span>, and we observe noisy
measurements of the vehicle’s position, <span class="math notranslate nohighlight">\(y_t \in \mathbf{R}^2\)</span>.</p>
<p>The matrices for the dynamics are</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \begin{bmatrix}
1 &amp; 0 &amp; \left(1-\frac{\gamma}{2}\Delta t\right) \Delta t &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; \left(1-\frac{\gamma}{2} \Delta t\right) \Delta t\\
0 &amp; 0 &amp; 1-\gamma \Delta t &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1-\gamma \Delta t
\end{bmatrix},\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}B = \begin{bmatrix}
\frac{1}{2}\Delta t^2 &amp; 0 \\
0 &amp; \frac{1}{2}\Delta t^2 \\
\Delta t &amp; 0 \\
0 &amp; \Delta t \\
\end{bmatrix},\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}C = \begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0
\end{bmatrix},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma\)</span> is a velocity damping parameter.</p>
</section>
<section id="d-model">
<h1>1D Model<a class="headerlink" href="#d-model" title="Permalink to this heading">¶</a></h1>
<p>The recurrence is derived from the following relations in a single
dimension. For this subsection, let <span class="math notranslate nohighlight">\(x_t, v_t, w_t\)</span> be the vehicle
position, velocity, and input drive force. The resulting acceleration of
the vehicle is <span class="math notranslate nohighlight">\(w_t - \gamma v_t\)</span>, with <span class="math notranslate nohighlight">\(- \gamma v_t\)</span> is a
damping term depending on velocity with parameter <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<p>The discretized dynamics are obtained from numerically integrating:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
x_{t+1} &amp;= x_t + \left(1-\frac{\gamma \Delta t}{2}\right)v_t \Delta t + \frac{1}{2}w_{t} \Delta t^2\\
v_{t+1} &amp;= \left(1-\gamma\right)v_t + w_t \Delta t.
\end{align}\end{split}\]</div>
<p>Extending these relations to two dimensions gives us the dynamics
matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p>
<section id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">plot_state</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">actual</span><span class="p">,</span> <span class="n">estimated</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    plot position, speed, and acceleration in the x and y coordinates for</span>
<span class="sd">    the actual data, and optionally for the estimated data</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">trajectories</span> <span class="o">=</span> <span class="p">[</span><span class="n">actual</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">estimated</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">trajectories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimated</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">trajectories</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x position&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x velocity&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x input&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y velocity&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y input&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_positions</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    show point clouds for true, observed, and recovered positions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traj</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">axis</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="problem-data">
<h2>Problem Data<a class="headerlink" href="#problem-data" title="Permalink to this heading">¶</a></h2>
<p>We generate the data for the vehicle tracking problem. We’ll have
<span class="math notranslate nohighlight">\(N=1000\)</span>, <span class="math notranslate nohighlight">\(w_t\)</span> a standard Gaussian, and <span class="math notranslate nohighlight">\(v_t\)</span> a
standard Gaussian, except <span class="math notranslate nohighlight">\(20\%\)</span> of the points will be outliers
with <span class="math notranslate nohighlight">\(\sigma = 20\)</span>.</p>
<p>Below, we set the problem parameters and define the matrices <span class="math notranslate nohighlight">\(A\)</span>,
<span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of timesteps</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># time will vary from 0 to T with step delt</span>
<span class="n">ts</span><span class="p">,</span> <span class="n">delt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">.05</span> <span class="c1"># damping, 0 is no damping</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="o">*</span><span class="n">delt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delt</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="o">*</span><span class="n">delt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delt</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">delt</span>
<span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">delt</span>

<span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span>
<span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span>

<span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="simulation">
<h1>Simulation<a class="headerlink" href="#simulation" title="Permalink to this heading">¶</a></h1>
<p>We seed <span class="math notranslate nohighlight">\(x_0 = 0\)</span> (starting at the origin with zero velocity) and
simulate the system forward in time. The results are the true vehicle
positions <code class="docutils literal notranslate"><span class="pre">x_true</span></code> (which we will use to judge our recovery) and the
observed positions <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>We plot the position, velocity, and system input <span class="math notranslate nohighlight">\(w\)</span> in both
dimensions as a function of time. We also plot the sets of true and
observed vehicle positions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">.20</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

<span class="c1"># generate random input and noise vectors</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># add outliers to v</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span>
<span class="n">v</span><span class="p">[:,</span><span class="n">inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)[:,</span><span class="n">inds</span><span class="p">]</span>

<span class="c1"># simulate the system forward in time</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span>

<span class="n">x_true</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">w_true</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">plot_state</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">x_true</span><span class="p">,</span><span class="n">w_true</span><span class="p">))</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Observed&#39;</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;rkf1.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/robust_kalman_6_0.png" src="../../_images/robust_kalman_6_0.png" />
<img alt="../../_images/robust_kalman_6_1.png" src="../../_images/robust_kalman_6_1.png" />
</section>
<section id="kalman-filtering-recovery">
<h1>Kalman filtering recovery<a class="headerlink" href="#kalman-filtering-recovery" title="Permalink to this heading">¶</a></h1>
<p>The code below solves the standard Kalman filtering problem using CVXPY.
We plot and compare the true and recovered vehicle states. Note that the
recovery is distorted by outliers in the measurements.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">tau</span> <span class="o">=</span> <span class="mf">.08</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum_squares</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">tau</span><span class="o">*</span><span class="n">cp</span><span class="o">.</span><span class="n">sum_squares</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">constr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">constr</span> <span class="o">+=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="p">,</span>
                <span class="n">y</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="o">==</span> <span class="n">C</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="p">]</span>

<span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constr</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">plot_state</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">x_true</span><span class="p">,</span><span class="n">w_true</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Noisy&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;KF recovery&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;rkf2.pdf&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal objective value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-----------------------------------------------------------------</span>
           <span class="n">OSQP</span> <span class="n">v0</span><span class="mf">.4.1</span>  <span class="o">-</span>  <span class="n">Operator</span> <span class="n">Splitting</span> <span class="n">QP</span> <span class="n">Solver</span>
              <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">Bartolomeo</span> <span class="n">Stellato</span><span class="p">,</span>  <span class="n">Goran</span> <span class="n">Banjac</span>
        <span class="n">University</span> <span class="n">of</span> <span class="n">Oxford</span>  <span class="o">-</span>  <span class="n">Stanford</span> <span class="n">University</span> <span class="mi">2018</span>
<span class="o">-----------------------------------------------------------------</span>
<span class="n">problem</span><span class="p">:</span>  <span class="n">variables</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">8004</span><span class="p">,</span> <span class="n">constraints</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">6000</span>
          <span class="n">nnz</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="n">nnz</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">=</span> <span class="mi">22000</span>
<span class="n">settings</span><span class="p">:</span> <span class="n">linear</span> <span class="n">system</span> <span class="n">solver</span> <span class="o">=</span> <span class="n">qdldl</span><span class="p">,</span>
          <span class="n">eps_abs</span> <span class="o">=</span> <span class="mf">1.0e-03</span><span class="p">,</span> <span class="n">eps_rel</span> <span class="o">=</span> <span class="mf">1.0e-03</span><span class="p">,</span>
          <span class="n">eps_prim_inf</span> <span class="o">=</span> <span class="mf">1.0e-04</span><span class="p">,</span> <span class="n">eps_dual_inf</span> <span class="o">=</span> <span class="mf">1.0e-04</span><span class="p">,</span>
          <span class="n">rho</span> <span class="o">=</span> <span class="mf">1.00e-01</span> <span class="p">(</span><span class="n">adaptive</span><span class="p">),</span>
          <span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.00e-06</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.60</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">4000</span>
          <span class="n">check_termination</span><span class="p">:</span> <span class="n">on</span> <span class="p">(</span><span class="n">interval</span> <span class="mi">25</span><span class="p">),</span>
          <span class="n">scaling</span><span class="p">:</span> <span class="n">on</span><span class="p">,</span> <span class="n">scaled_termination</span><span class="p">:</span> <span class="n">off</span>
          <span class="n">warm</span> <span class="n">start</span><span class="p">:</span> <span class="n">on</span><span class="p">,</span> <span class="n">polish</span><span class="p">:</span> <span class="n">on</span>

<span class="nb">iter</span>   <span class="n">objective</span>    <span class="n">pri</span> <span class="n">res</span>    <span class="n">dua</span> <span class="n">res</span>    <span class="n">rho</span>        <span class="n">time</span>
   <span class="mi">1</span>   <span class="mf">0.0000e+00</span>   <span class="mf">6.14e+01</span>   <span class="mf">6.14e+03</span>   <span class="mf">1.00e-01</span>   <span class="mf">1.28e-02</span><span class="n">s</span>
  <span class="mi">50</span>   <span class="mf">1.1057e+04</span>   <span class="mf">3.57e-07</span>   <span class="mf">8.27e-08</span>   <span class="mf">1.00e-01</span>   <span class="mf">3.01e-02</span><span class="n">s</span>
<span class="n">plsh</span>   <span class="mf">1.1057e+04</span>   <span class="mf">7.11e-15</span>   <span class="mf">1.24e-14</span>   <span class="o">--------</span>   <span class="mf">3.78e-02</span><span class="n">s</span>

<span class="n">status</span><span class="p">:</span>               <span class="n">solved</span>
<span class="n">solution</span> <span class="n">polish</span><span class="p">:</span>      <span class="n">successful</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span><span class="p">:</span> <span class="mi">50</span>
<span class="n">optimal</span> <span class="n">objective</span><span class="p">:</span>    <span class="mf">11057.3550</span>
<span class="n">run</span> <span class="n">time</span><span class="p">:</span>             <span class="mf">3.78e-02</span><span class="n">s</span>
<span class="n">optimal</span> <span class="n">rho</span> <span class="n">estimate</span><span class="p">:</span> <span class="mf">7.70e-02</span>

<span class="n">optimal</span> <span class="n">objective</span> <span class="n">value</span><span class="p">:</span> <span class="mf">11057.354957764113</span>
<span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mi">13</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">598</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">13.6</span> <span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">13.8</span> <span class="n">s</span>
</pre></div>
</div>
<img alt="../../_images/robust_kalman_8_1.png" src="../../_images/robust_kalman_8_1.png" />
<img alt="../../_images/robust_kalman_8_2.png" src="../../_images/robust_kalman_8_2.png" />
<img alt="../../_images/robust_kalman_8_3.png" src="../../_images/robust_kalman_8_3.png" />
</section>
<section id="robust-kalman-filtering-recovery">
<h1>Robust Kalman filtering recovery<a class="headerlink" href="#robust-kalman-filtering-recovery" title="Permalink to this heading">¶</a></h1>
<p>Here we implement robust Kalman filtering with CVXPY. We get a better
recovery than the standard Kalman filtering, which can be seen in the
plots below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum_squares</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">+=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">tau</span><span class="o">*</span><span class="n">cp</span><span class="o">.</span><span class="n">huber</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]),</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">constr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">constr</span> <span class="o">+=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="p">,</span>
                <span class="n">y</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="o">==</span> <span class="n">C</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="p">]</span>

<span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constr</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">plot_state</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">x_true</span><span class="p">,</span><span class="n">w_true</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Noisy&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Robust KF recovery&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;rkf3.pdf&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal objective value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECOS</span> <span class="mf">2.0.4</span> <span class="o">-</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">embotech</span> <span class="n">GmbH</span><span class="p">,</span> <span class="n">Zurich</span> <span class="n">Switzerland</span><span class="p">,</span> <span class="mi">2012</span><span class="o">-</span><span class="mf">15.</span> <span class="n">Web</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">embotech</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ECOS</span>

<span class="n">It</span>     <span class="n">pcost</span>       <span class="n">dcost</span>      <span class="n">gap</span>   <span class="n">pres</span>   <span class="n">dres</span>    <span class="n">k</span><span class="o">/</span><span class="n">t</span>    <span class="n">mu</span>     <span class="n">step</span>   <span class="n">sigma</span>     <span class="n">IR</span>    <span class="o">|</span>   <span class="n">BT</span>
 <span class="mi">0</span>  <span class="o">+</span><span class="mf">0.000e+00</span>  <span class="o">-</span><span class="mf">2.923e+02</span>  <span class="o">+</span><span class="mf">7e+05</span>  <span class="mf">3e-01</span>  <span class="mf">3e-02</span>  <span class="mf">1e+00</span>  <span class="mf">2e+02</span>    <span class="o">---</span>    <span class="o">---</span>    <span class="mi">1</span>  <span class="mi">1</span>  <span class="o">-</span> <span class="o">|</span>  <span class="o">-</span>  <span class="o">-</span>
 <span class="mi">1</span>  <span class="o">+</span><span class="mf">5.090e+02</span>  <span class="o">+</span><span class="mf">4.360e+02</span>  <span class="o">+</span><span class="mf">2e+05</span>  <span class="mf">4e-01</span>  <span class="mf">1e-02</span>  <span class="mf">3e+01</span>  <span class="mf">6e+01</span>  <span class="mf">0.8051</span>  <span class="mf">2e-01</span>   <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">2</span>  <span class="o">+</span><span class="mf">4.188e+03</span>  <span class="o">+</span><span class="mf">4.134e+03</span>  <span class="o">+</span><span class="mf">2e+05</span>  <span class="mf">3e-01</span>  <span class="mf">9e-03</span>  <span class="mf">3e+01</span>  <span class="mf">5e+01</span>  <span class="mf">0.4259</span>  <span class="mf">6e-01</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">3</span>  <span class="o">+</span><span class="mf">9.956e+03</span>  <span class="o">+</span><span class="mf">9.923e+03</span>  <span class="o">+</span><span class="mf">1e+05</span>  <span class="mf">3e-01</span>  <span class="mf">8e-03</span>  <span class="mf">4e+01</span>  <span class="mf">4e+01</span>  <span class="mf">0.5830</span>  <span class="mf">5e-01</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">4</span>  <span class="o">+</span><span class="mf">1.881e+04</span>  <span class="o">+</span><span class="mf">1.880e+04</span>  <span class="o">+</span><span class="mf">7e+04</span>  <span class="mf">3e-01</span>  <span class="mf">5e-03</span>  <span class="mf">3e+01</span>  <span class="mf">2e+01</span>  <span class="mf">0.7189</span>  <span class="mf">3e-01</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">5</span>  <span class="o">+</span><span class="mf">2.572e+04</span>  <span class="o">+</span><span class="mf">2.572e+04</span>  <span class="o">+</span><span class="mf">4e+04</span>  <span class="mf">2e-01</span>  <span class="mf">3e-03</span>  <span class="mf">2e+01</span>  <span class="mf">1e+01</span>  <span class="mf">0.5464</span>  <span class="mf">3e-01</span>   <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">6</span>  <span class="o">+</span><span class="mf">2.986e+04</span>  <span class="o">+</span><span class="mf">2.985e+04</span>  <span class="o">+</span><span class="mf">3e+04</span>  <span class="mf">2e-01</span>  <span class="mf">2e-03</span>  <span class="mf">1e+01</span>  <span class="mf">6e+00</span>  <span class="mf">0.5716</span>  <span class="mf">3e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">7</span>  <span class="o">+</span><span class="mf">3.262e+04</span>  <span class="o">+</span><span class="mf">3.262e+04</span>  <span class="o">+</span><span class="mf">1e+04</span>  <span class="mf">9e-02</span>  <span class="mf">1e-03</span>  <span class="mf">7e+00</span>  <span class="mf">3e+00</span>  <span class="mf">0.6007</span>  <span class="mf">2e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">8</span>  <span class="o">+</span><span class="mf">3.425e+04</span>  <span class="o">+</span><span class="mf">3.425e+04</span>  <span class="o">+</span><span class="mf">8e+03</span>  <span class="mf">5e-02</span>  <span class="mf">7e-04</span>  <span class="mf">5e+00</span>  <span class="mf">2e+00</span>  <span class="mf">0.5871</span>  <span class="mf">3e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
 <span class="mi">9</span>  <span class="o">+</span><span class="mf">3.601e+04</span>  <span class="o">+</span><span class="mf">3.601e+04</span>  <span class="o">+</span><span class="mf">4e+03</span>  <span class="mf">3e-02</span>  <span class="mf">3e-04</span>  <span class="mf">2e+00</span>  <span class="mf">9e-01</span>  <span class="mf">0.6383</span>  <span class="mf">2e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">10</span>  <span class="o">+</span><span class="mf">3.728e+04</span>  <span class="o">+</span><span class="mf">3.727e+04</span>  <span class="o">+</span><span class="mf">2e+03</span>  <span class="mf">1e-02</span>  <span class="mf">2e-04</span>  <span class="mf">1e+00</span>  <span class="mf">5e-01</span>  <span class="mf">0.7925</span>  <span class="mf">4e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">11</span>  <span class="o">+</span><span class="mf">3.759e+04</span>  <span class="o">+</span><span class="mf">3.759e+04</span>  <span class="o">+</span><span class="mf">1e+03</span>  <span class="mf">1e-02</span>  <span class="mf">1e-04</span>  <span class="mf">1e+00</span>  <span class="mf">3e-01</span>  <span class="mf">0.5191</span>  <span class="mf">5e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">12</span>  <span class="o">+</span><span class="mf">3.824e+04</span>  <span class="o">+</span><span class="mf">3.824e+04</span>  <span class="o">+</span><span class="mf">6e+02</span>  <span class="mf">6e-03</span>  <span class="mf">5e-05</span>  <span class="mf">5e-01</span>  <span class="mf">2e-01</span>  <span class="mf">0.9890</span>  <span class="mf">4e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">13</span>  <span class="o">+</span><span class="mf">3.860e+04</span>  <span class="o">+</span><span class="mf">3.860e+04</span>  <span class="o">+</span><span class="mf">3e+02</span>  <span class="mf">3e-03</span>  <span class="mf">2e-05</span>  <span class="mf">3e-01</span>  <span class="mf">7e-02</span>  <span class="mf">0.6740</span>  <span class="mf">2e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">14</span>  <span class="o">+</span><span class="mf">3.864e+04</span>  <span class="o">+</span><span class="mf">3.864e+04</span>  <span class="o">+</span><span class="mf">3e+02</span>  <span class="mf">3e-03</span>  <span class="mf">2e-05</span>  <span class="mf">3e-01</span>  <span class="mf">7e-02</span>  <span class="mf">0.2982</span>  <span class="mf">7e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">15</span>  <span class="o">+</span><span class="mf">3.876e+04</span>  <span class="o">+</span><span class="mf">3.876e+04</span>  <span class="o">+</span><span class="mf">2e+02</span>  <span class="mf">2e-03</span>  <span class="mf">1e-05</span>  <span class="mf">2e-01</span>  <span class="mf">4e-02</span>  <span class="mf">0.9890</span>  <span class="mf">6e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">16</span>  <span class="o">+</span><span class="mf">3.889e+04</span>  <span class="o">+</span><span class="mf">3.889e+04</span>  <span class="o">+</span><span class="mf">8e+01</span>  <span class="mf">1e-03</span>  <span class="mf">4e-06</span>  <span class="mf">1e-01</span>  <span class="mf">2e-02</span>  <span class="mf">0.7740</span>  <span class="mf">4e-01</span>   <span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">17</span>  <span class="o">+</span><span class="mf">3.899e+04</span>  <span class="o">+</span><span class="mf">3.899e+04</span>  <span class="o">+</span><span class="mf">2e+01</span>  <span class="mf">4e-04</span>  <span class="mf">1e-06</span>  <span class="mf">3e-02</span>  <span class="mf">6e-03</span>  <span class="mf">0.9702</span>  <span class="mf">3e-01</span>   <span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">18</span>  <span class="o">+</span><span class="mf">3.901e+04</span>  <span class="o">+</span><span class="mf">3.901e+04</span>  <span class="o">+</span><span class="mf">1e+01</span>  <span class="mf">4e-04</span>  <span class="mf">6e-07</span>  <span class="mf">3e-02</span>  <span class="mf">4e-03</span>  <span class="mf">0.6771</span>  <span class="mf">5e-01</span>   <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">19</span>  <span class="o">+</span><span class="mf">3.903e+04</span>  <span class="o">+</span><span class="mf">3.903e+04</span>  <span class="o">+</span><span class="mf">7e+00</span>  <span class="mf">2e-04</span>  <span class="mf">3e-07</span>  <span class="mf">2e-02</span>  <span class="mf">2e-03</span>  <span class="mf">0.9383</span>  <span class="mf">5e-01</span>   <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">20</span>  <span class="o">+</span><span class="mf">3.905e+04</span>  <span class="o">+</span><span class="mf">3.905e+04</span>  <span class="o">+</span><span class="mf">2e+00</span>  <span class="mf">1e-04</span>  <span class="mf">1e-07</span>  <span class="mf">1e-02</span>  <span class="mf">6e-04</span>  <span class="mf">0.8982</span>  <span class="mf">3e-01</span>   <span class="mi">4</span>  <span class="mi">4</span>  <span class="mi">4</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">21</span>  <span class="o">+</span><span class="mf">3.906e+04</span>  <span class="o">+</span><span class="mf">3.906e+04</span>  <span class="o">+</span><span class="mf">9e-01</span>  <span class="mf">5e-05</span>  <span class="mf">5e-08</span>  <span class="mf">5e-03</span>  <span class="mf">2e-04</span>  <span class="mf">0.9342</span>  <span class="mf">3e-01</span>   <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">22</span>  <span class="o">+</span><span class="mf">3.907e+04</span>  <span class="o">+</span><span class="mf">3.907e+04</span>  <span class="o">+</span><span class="mf">3e-01</span>  <span class="mf">4e-05</span>  <span class="mf">3e-08</span>  <span class="mf">4e-03</span>  <span class="mf">8e-05</span>  <span class="mf">0.8457</span>  <span class="mf">3e-01</span>   <span class="mi">5</span>  <span class="mi">4</span>  <span class="mi">4</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">23</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">8e-02</span>  <span class="mf">1e-05</span>  <span class="mf">8e-09</span>  <span class="mf">1e-03</span>  <span class="mf">2e-05</span>  <span class="mf">0.9890</span>  <span class="mf">3e-01</span>   <span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">24</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">1e-02</span>  <span class="mf">2e-06</span>  <span class="mf">2e-09</span>  <span class="mf">2e-04</span>  <span class="mf">3e-06</span>  <span class="mf">0.9013</span>  <span class="mf">5e-02</span>   <span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">25</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">2e-03</span>  <span class="mf">4e-07</span>  <span class="mf">4e-10</span>  <span class="mf">4e-05</span>  <span class="mf">5e-07</span>  <span class="mf">0.9207</span>  <span class="mf">8e-02</span>   <span class="mi">3</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">26</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">7e-04</span>  <span class="mf">2e-07</span>  <span class="mf">2e-10</span>  <span class="mf">2e-05</span>  <span class="mf">2e-07</span>  <span class="mf">0.9890</span>  <span class="mf">4e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">27</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">8e-05</span>  <span class="mf">3e-08</span>  <span class="mf">5e-11</span>  <span class="mf">2e-06</span>  <span class="mf">2e-08</span>  <span class="mf">0.9009</span>  <span class="mf">2e-02</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">28</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">2e-05</span>  <span class="mf">1e-08</span>  <span class="mf">2e-11</span>  <span class="mf">4e-07</span>  <span class="mf">5e-09</span>  <span class="mf">0.9890</span>  <span class="mf">2e-01</span>   <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="mi">29</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">3.908e+04</span>  <span class="o">+</span><span class="mf">2e-06</span>  <span class="mf">3e-09</span>  <span class="mf">5e-12</span>  <span class="mf">5e-08</span>  <span class="mf">5e-10</span>  <span class="mf">0.9058</span>  <span class="mf">2e-02</span>   <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>  <span class="mi">0</span>

<span class="n">OPTIMAL</span> <span class="p">(</span><span class="n">within</span> <span class="n">feastol</span><span class="o">=</span><span class="mf">3.1e-09</span><span class="p">,</span> <span class="n">reltol</span><span class="o">=</span><span class="mf">5.3e-11</span><span class="p">,</span> <span class="n">abstol</span><span class="o">=</span><span class="mf">2.1e-06</span><span class="p">)</span><span class="o">.</span>
<span class="n">Runtime</span><span class="p">:</span> <span class="mf">1.129066</span> <span class="n">seconds</span><span class="o">.</span>

<span class="n">optimal</span> <span class="n">objective</span> <span class="n">value</span><span class="p">:</span> <span class="mf">39077.76954636933</span>
<span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mi">3</span><span class="nb">min</span> <span class="mi">37</span><span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mf">3.44</span> <span class="n">s</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mi">3</span><span class="nb">min</span> <span class="mi">41</span><span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mi">3</span><span class="nb">min</span> <span class="mi">55</span><span class="n">s</span>
</pre></div>
</div>
<img alt="../../_images/robust_kalman_10_1.png" src="../../_images/robust_kalman_10_1.png" />
<img alt="../../_images/robust_kalman_10_2.png" src="../../_images/robust_kalman_10_2.png" />
<img alt="../../_images/robust_kalman_10_3.png" src="../../_images/robust_kalman_10_3.png" />
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">CVXPY</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cvxpy&repo=cvxpy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/cvxpy.html">API Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../citing/index.html">Citing CVXPY</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../related_projects/index.html">Related Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../updates/index.html">Changes to CVXPY</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../short_course/index.html">CVXPY Short Course</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license/index.html">License</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div>
    <h3>
        Version selector
    </h3>
    <select id="dynamic_selector" name="versions" onchange="if (this.value) window.location.href=this.value">
    </select>
    <script>
        obj = $.getJSON("https://raw.githubusercontent.com/cvxpy/cvxpy/gh-pages/versions.json")
            .done(function (data) {
                const base_url = "https://www.cvxpy.org/"
                let html = "<option value='' selected>Choose version here</option>";
                html += "<option value=" + base_url + ">latest" + ""
                for (let i = 0; i < data.length; i++) {
                    html += "<option value=" + base_url + "version/"  + data[i] + ">" + data[i] + ""
                }
                document.getElementById("dynamic_selector").innerHTML = html;
            });
    </script>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;The CVXPY authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/examples/applications/robust_kalman.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/cvxpy/cvxpy" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-50248335-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>