
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Machine Learning: Lasso Regression &#8212; CVXPY 1.0.10 documentation</title>
    <link rel="stylesheet" href="../../_static/cvxpy_alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="machine-learning-lasso-regression">
<h1>Machine Learning: Lasso Regression<a class="headerlink" href="#machine-learning-lasso-regression" title="Permalink to this headline">¶</a></h1>
<p>Lasso regression is, like ridge regression, a <strong>shrinkage</strong> method. It
differs from ridge regression in its choice of penalty: lasso imposes an
<span class="math">\(\ell_1\)</span> <strong>penalty</strong> on the paramters <span class="math">\(\beta\)</span>. That is,
lasso finds an assignment to <span class="math">\(\beta\)</span> that minimizes the function</p>
<div class="math">
\[f(\beta) = \|X\beta - Y\|_2^2 + \lambda \|\beta\|_1,\]</div>
<p>where <span class="math">\(\lambda\)</span> is a hyperparameter and, as usual, <span class="math">\(X\)</span> is
the training data and <span class="math">\(Y\)</span> the observations. The <span class="math">\(\ell_1\)</span>
penalty encourages <strong>sparsity</strong> in the learned parameters, and, as we
will see, can drive many coefficients to zero. In this sense, lasso is a
continuous <strong>feature selection</strong> method.</p>
<p>In this notebook, we show how to fit a lasso model using CVXPY, how to
evaluate the model, and how to tune the hyperparameter <span class="math">\(\lambda\)</span>.</p>
<div class="section" id="writing-the-objective-function">
<h2>Writing the objective function<a class="headerlink" href="#writing-the-objective-function" title="Permalink to this headline">¶</a></h2>
<p>We can decompose the <strong>objective function</strong> as the sum of a <strong>least
squares loss function</strong> and an <span class="math">\(\ell_1\)</span> <strong>regularizer</strong>.</p>
</div>
<div class="section" id="generating-data">
<h2>Generating data<a class="headerlink" href="#generating-data" title="Permalink to this headline">¶</a></h2>
<p>We generate training examples and observations that are linearly
related; we make the relationship <em>sparse</em>, and we’ll see how lasso will
approximately recover it.</p>
</div>
<div class="section" id="fitting-the-model">
<h2>Fitting the model<a class="headerlink" href="#fitting-the-model" title="Permalink to this headline">¶</a></h2>
<p>All we need to do to fit the model is create a CVXPY problem where the
objective is to minimize the the objective function defined above. We
make <span class="math">\(\lambda\)</span> a CVXPY parameter, so that we can use a single
CVXPY problem to obtain estimates for many values of <span class="math">\(\lambda\)</span>.</p>
</div>
<div class="section" id="evaluating-the-model">
<h2>Evaluating the model<a class="headerlink" href="#evaluating-the-model" title="Permalink to this headline">¶</a></h2>
<p>Just as we saw for ridge regression, regularization improves
generalizability.</p>
<img alt="../../_images/lasso_regression_9_0.svg" src="../../_images/lasso_regression_9_0.svg" /></div>
<div class="section" id="regularization-path-and-feature-selection">
<h2>Regularization path and feature selection<a class="headerlink" href="#regularization-path-and-feature-selection" title="Permalink to this headline">¶</a></h2>
<p>As <span class="math">\(\lambda\)</span> increases, the parameters are driven to <span class="math">\(0\)</span>. By
<span class="math">\(\lambda \approx 10\)</span>, approximately 80 percent of the coefficients
are <em>exactly</em> zero. This parallels the fact that <span class="math">\(\beta^*\)</span> was
generated such that 80 percent of its entries were zero. The features
corresponding to the slowest decaying coefficients can be interpreted as
the most important ones.</p>
<p><strong>Qualitatively, lasso differs from ridge in that the former often
drives parameters to exactly zero, whereas the latter shrinks parameters
but does not usually zero them out. That is, lasso results in sparse
models; ridge (usually) does not.</strong></p>
<img alt="../../_images/lasso_regression_11_0.svg" src="../../_images/lasso_regression_11_0.svg" /></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">CVXPY</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cvxgrp&repo=cvxpy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/cvxpy.html">API Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../citing/index.html">Citing CVXPY</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../related_projects/index.html">Related Projects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../updates/index.html">What’s New in 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../short_course/index.html">CVXPY Short Course</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license/index.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions/index.html">Versions</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Steven Diamond, Eric Chu, Akshay Agrawal, Stephen Boyd.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/examples/machine_learning/lasso_regression.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/cvxgrp/cvxpy" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-50248335-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>